---
title: "Homework N Responses"
author: "Zeyi Han, Shubhi Sharma, Margaret Swift"
date: '`r Sys.Date()`'
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
---

```{r setup, include=F}
#----------------------------------------------------------------------------
# LOADING
knitr::opts_chunk$set(echo=FALSE, eval=TRUE, cache=FALSE)
pacman::p_load(ggplot2)
source('../clarkfunctions2020.R')
Rcpp::sourceCpp('../cppFns.cpp')
# any libraries and data here

#----------------------------------------------------------------------------
# FUNCTIONS
# put functions here

```


## Exercise 1 {#q1}

_Conduct simulation experiments to determine how sample size and number of response variables affects estimates of the coefficients and covariance matrix._

```{r q1}
#----------------------------------------------------------------------------
## EXERCISE 1

```


## Exercise 2 {#q2}

_Jon has a survey with one binary response (`typeNames = 'PA'`) and three ordinal responses (ordinal counts, `'OC'`).  Simulate his data using `gjamSimData` and analyze it using `gjam`.  Using the documentation for `gjam`:

a) What are the partition estimates and what role do they play?

b) Which are better predicted by the fitted model, the `PA` data or the `OC` data?  Why might they differ?_

```{r q2}
#----------------------------------------------------------------------------
## EXERCISE 2

```


## Exercise 3 {#q3}

_Select 10 species from the BBS data and do a model selection (using DIC) to evaluate a limited number of variable combinations.

a) How do the DIC values compare with overall sensitivity?

b) With inverse prediction?_

```{r q3, echo = TRUE, eval = FALSE}
#----------------------------------------------------------------------------
## EXERCISE 3

load('BBSeast.Rdata')
require(gjam)


tmp <- gjamTrimY(ydata, 1000)
ytrim <- tmp$y                 #trimmed version of ydata
dim(ytrim)

reductList <- list(N = 20, r = 15)
modelList  <- list(ng = 2000, burnin = 500, typeNames='DA', 
                   reductList = reductList)
formula1 <- as.formula(~ winterTemp + therm + def + nlcd)

outBBS  <- gjam(formula1, xdata, ydata = ytrim, modelList = modelList)
outBBS$fit$DIC

formula2 <- as.formula(~ obsTemp + prec + ncld + soil)
outBBS2  <- gjam(formula1, xdata, ydata = ytrim, modelList = modelList)
outBBS2$fit$DIC

formula3 <- as.formula(~ Longitude + Latitude + ncld )
outBBS3 <- gjam(formula1, xdata, ydata = ytrim, modelList = modelList)
outBBS3$fit$DIC

formula4 <- as.formula(~ def + prec + obsTemp + ncld)
outBB4  <- gjam(formula1, xdata, ydata = ytrim, modelList = modelList)
outBB4$fit$DIC

```

\begin{table}[h!]
    \begin{center}
    \caption{Model with DIC values for different GJAM models}
    \label{table:1}
    \begin{tabular}{|| c c c ||}
    \hline 
    \hline
     Model Name & Formula & DIC  \\ [0.5ex]
     \hline 
     outBBS & $\sim$ winterTemp + therm + def + ncld & 10539378 \\
     \hline 
     outBBS2 & $\sim$ obsTemp + prec + ncld + soil &  10566072 \\
     \hline 
     outBBS3 & $\sim$ Longitude + Latitude + ncld &  10591289\\
     \hline 
     outBB4 & $\sim$ def + prec + obsTemp + ncld & 10634372\\
     \hline
     \hline
 \end{tabular}
    \end{center}
    \end{table}


From the analysis of DIC for different combinations of GJAM models for a given 20 species, we find that the first model with covariates `winterTemp`, `therm`, `def` and `ncld` has the lowest DIC value and therefore is preferred to other models with higher DICs. 

This model has extremely good inverse prediction and covariate sensitivity for ncld is ~ 0.02, therm = 0.02, wintertemp < 0.05 and finally winterTemp ~ 0.2. 

Compared to other models with higher DICs, while they also have good inverse predictions, the model sensitivites are usually much more uncertain (i.e. larger credible intervals). Notably, most models have similar sensitivities. 



```


## Exercise 4 {#q4}

Using the block of code that generates the predictive coefficient of variation, provide an interpretation of what you see.

```{r q4}
#----------------------------------------------------------------------------
## EXERCISE 4

```


## Appendix {#appendix}

```{r ref.label=knitr::all_labels(), echo = T, eval = F}
```


